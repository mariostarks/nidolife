!function(){"use strict";angular.module("ionic-ajax-interceptor",["ionic"])}(),function(n){"use strict";n.provider("AjaxInterceptor",["$httpProvider",function(n){var o={title:"Error",defaultMessage:"Unknown error",authorizationHeader:"Authorization",authorizationToken:null,stateChangeError:!0,fallbackIp:null};return{config:function(t){angular.extend(o,t),n.interceptors.push(["$rootScope","$q","$injector",function(n,t,r){return{request:function(t){return n.$broadcast("loading:show"),o.authorizationToken&&(t.headers[o.authorizationHeader]=o.authorizationToken),t},requestError:function(o){return n.$broadcast("loading:hide"),t.reject(o)},response:function(o){return n.$broadcast("loading:hide"),o},responseError:function(i){if(0==i.status){var e=i.config.url.split("/");if(e[2]!==o.fallbackIp){e[2]=o.fallbackIp,i.config.url=e.join("/");var a=r.get("$http");return a(i.config)}}return n.$broadcast("loading:hide"),t.reject(i)}}}])},$get:["$ionicPopup","$ionicLoading","$rootScope",function(n,t,r){var i=0,e=function(){0===i&&t.show({content:"Loading",animation:"fade-in",showBackdrop:!0,maxWidth:200,showDelay:0}),i++},a=function(){i--,0==i?t.hide():0>i&&(i=0)};return{run:function(){o.stateChangeError&&r.$on("$stateChangeError",function(t,r,i,e,a,u){n.alert({title:o.title,content:u.message||o.defaultMessage})}),r.$on("loading:show",function(){e()}),r.$on("loading:hide",function(){a()})},setAuthorizationToken:function(n){o.authorizationToken=n},showLoading:function(){e()},hideLoading:function(){a()}}}]}}])}(angular.module("ionic-ajax-interceptor"));